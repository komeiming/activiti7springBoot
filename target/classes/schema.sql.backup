-- 用户表
CREATE TABLE IF NOT EXISTS sys_user (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    full_name VARCHAR(100),
    email VARCHAR(100),
    phone VARCHAR(20),
    status INT DEFAULT 1,
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 角色表
CREATE TABLE IF NOT EXISTS sys_role (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    role_name VARCHAR(50) NOT NULL,
    role_code VARCHAR(50) NOT NULL UNIQUE,
    description VARCHAR(200)
);

-- 用户角色关联表
CREATE TABLE IF NOT EXISTS sys_user_role (
    user_id BIGINT NOT NULL,
    role_id BIGINT NOT NULL,
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES sys_user(id),
    FOREIGN KEY (role_id) REFERENCES sys_role(id)
);

-- 流程表单数据表（用于员工onboard流程）
CREATE TABLE IF NOT EXISTS employee_onboard (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    process_instance_id VARCHAR(100) NOT NULL,
    employee_name VARCHAR(100) NOT NULL,
    employee_id VARCHAR(50) NOT NULL,
    department VARCHAR(100) NOT NULL,
    position VARCHAR(100) NOT NULL,
    hire_date DATE NOT NULL,
    manager_name VARCHAR(100),
    it_equipment_status VARCHAR(20) DEFAULT 'PENDING',
    hr_document_status VARCHAR(20) DEFAULT 'PENDING',
    training_status VARCHAR(20) DEFAULT 'PENDING',
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 初始化角色数据
INSERT INTO sys_role (role_name, role_code, description) VALUES 
('管理员', 'ROLE_ADMIN', '系统管理员角色'),
('普通用户', 'ROLE_USER', '普通用户角色'),
('部门经理', 'ROLE_MANAGER', '部门经理角色'),
('IT管理员', 'ROLE_IT_ADMIN', 'IT管理员角色'),
('HR专员', 'ROLE_HR', '人力资源专员角色');

-- 初始化用户数据（密码使用明文存储，实际生产环境应使用加密）
INSERT INTO sys_user (username, password, full_name, email, phone) VALUES 
('admin', 'password', '系统管理员', 'admin@example.com', '13800138000'),
('user', 'password', '普通用户', 'user@example.com', '13800138001'),
('manager', 'password', '部门经理', 'manager@example.com', '13800138002'),
('itadmin', 'password', 'IT管理员', 'itadmin@example.com', '13800138003'),
('hr', 'password', 'HR专员', 'hr@example.com', '13800138004');

-- 初始化用户角色关联
INSERT INTO sys_user_role (user_id, role_id) VALUES 
(1, 1), -- admin 拥有管理员角色
(2, 2), -- user 拥有普通用户角色
(3, 3), -- manager 拥有部门经理角色
(4, 4), -- itadmin 拥有IT管理员角色
(5, 5); -- hr 拥有HR专员角色